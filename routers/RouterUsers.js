"use strict";

const path = require("path");
const express = require("express");
const multer = require("multer");
const multerFactory = multer({ dest: path.join(__dirname, "../public/profile_img") });


var user = express.Router();

const ControllerUsuario = require("../controllers/ControllerUsers");



/*
****************************************************************************************************************************************************************
                LOGGIN
****************************************************************************************************************************************************************                                                                   
*/

user.get("/login.html",ControllerUsuario.acceso_login);
user.post("/login", ControllerUsuario.login);

/*
****************************************************************************************************************************************************************
                       CREAR CUENTA
****************************************************************************************************************************************************************                                                                   
*/

user.get("/crear_cuenta.html", ControllerUsuario.acceso_crear_cuenta);

user.post("/crearCuenta", multerFactory.single("icon"), ControllerUsuario.crear_cuenta);

user.get("../public/profile_img/:id", function(request, response){
    let pathImg = path.join(__dirname, "../public/profile_img", request.params.id);
    response.sendFile(pathImg);
});
/*
****************************************************************************************************************************************************************
                LOGOUT USUARIO
****************************************************************************************************************************************************************                                                                   
*/

user.get("/logout", ControllerUsuario.logout);

/*
****************************************************************************************************************************************************************
               PAGINA PRINCIPAL
****************************************************************************************************************************************************************                                                                   
*/

user.get("/pag_principal.html", ControllerUsuario.pag_principal);

/*
****************************************************************************************************************************************************************
                            USUARIOS
****************************************************************************************************************************************************************                                                                   
*/

user.get("/usuarios.html", ControllerUsuario.usuarios);

/*
****************************************************************************************************************************************************************
                    PERFIL  USUARIOS
****************************************************************************************************************************************************************                                                                   
*/

user.get("/perfil_usu/:idUsuario", ControllerUsuario.perfil_usu);

/*
****************************************************************************************************************************************************************
                FILTRAR POR TEXTO
****************************************************************************************************************************************************************                                                                   
*/

user.post("/buscarUsuario", ControllerUsuario.filtrar_usuario);

module.exports = user;